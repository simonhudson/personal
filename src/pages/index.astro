---
import * as contentful from 'contentful';
import Layout from '@/src/layouts/Layout.astro';
import Header from '@/src/components/header/header.astro';
import  Hero from '@/src/components/hero/hero.astro';
import  About from '@/src/components/about/about.astro';
import Portfolio from '@/src/components/portfolio/portfolio.astro';
import Footer from '@/src/components/footer/footer.astro';

const getCmsData = async () => {

	console.log('x----------------');
	console.log('space', import.meta.env.CONTENTFUL_SPACE_ID, process.env.CONTENTFUL_SPACE_ID);
	console.log('token', import.meta.env.CONTENTFUL_ACCESS_TOKEN, process.env.CONTENTFUL_ACCESS_TOKEN);
	console.log('/x----------------');
	

	const contentfulClient = contentful.createClient({
      space: import.meta.env.CONTENTFUL_SPACE_ID ?? "",
      accessToken: import.meta.env.CONTENTFUL_ACCESS_TOKEN ?? "",
    });
	const entries = await contentfulClient.getEntries();
	return entries;
};

const cmsData = await getCmsData();

const portfolioData = cmsData.items
		.filter((item: any) => item.sys.contentType.sys.id === 'portfolioItem')
		.map((item: any) => item.fields);

const aboutData = cmsData.items.find((item: any) => item.sys.contentType.sys.id === 'aboutMe')?.fields;
---
<Layout>
  <Header />
  <Hero />
    <About data={aboutData} />
	<Portfolio items={portfolioData} />    
	<Footer />
</Layout>