---
import * as contentful from 'contentful';
import Layout from '@/src/layouts/Layout.astro';
import Header from '@/src/components/header/header.astro';
import  Hero from '@/src/components/hero/hero.astro';
import  About from '@/src/components/about/about.astro';
import Portfolio from '@/src/components/portfolio/portfolio.astro';
import Footer from '@/src/components/footer/footer.astro';

const getCmsData = async () => {
	const contentfulClient = contentful.createClient({
      space: process.env.CONTENTFUL_SPACE_ID ?? "",
      accessToken: process.env.CONTENTFUL_ACCESS_TOKEN ?? "",
    });
	const entries = await contentfulClient.getEntries();
	return entries;
};

const cmsData = await getCmsData();

const portfolioData = cmsData.items
		.filter((item: any) => item.sys.contentType.sys.id === 'portfolioItem')
		.map((item: any) => item.fields);

const aboutData = cmsData.items.find((item: any) => item.sys.contentType.sys.id === 'aboutMe')?.fields;

---
<Layout>
  <Header />
  <Hero />
    <About data={aboutData} />
	<Portfolio items={portfolioData} />    
	<Footer />
</Layout>